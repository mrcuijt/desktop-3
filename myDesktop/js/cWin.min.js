!function(){var a=$(window),b=$(document),c=function(a){return new c.prototype.init(a)};c.prototype={constructor:c,jsonOnly:{zIndex:1e9},init:function(a){this.win=null,this.title=null,this.minBtn=null,this.maxBtn=null,this.closeBtn=null,this.finish=null,this.cancel=null,this.mark=null,this.div=null,this.settings={format:"tc",width:800,height:500,wz:"ct",title:"窗口标题",dblclick:!0,mark:!1,titleDrag:!0,wholeDrag:!1,dragLimit:!0,changeWin:!1,removeDisplay:!1,html:""},this.private={bBtn:!0,left:0,top:0},$.extend(this.settings,a),this.jsonOnly[this.settings.id]?($("#"+this.settings.id).css("visibility","visible").attr("kai","zhe").find(".win_title").html(this.settings.title),this.settings.mark&&$("#mark"+this.settings.id).css({display:"block"})):(this.jsonOnly[this.settings.id]=!0,this.createWin(),"tc"==this.settings.format&&(this.xiaoWin(),this.daWin()),this.settings.dblclick&&this.dblDaWin(),this.shutWin(),this.onresize(),(this.settings.titleDrag||this.settings.changeWin)&&this.dragWin(),this.settings.mark&&this.createMark())},createWin:function(){var a="",b="",c="",d="";this.settings.changeWin&&(a='<span class="l_edge pae"></span><span class="b_edge pae"></span><span class="l_b_horn pae"></span>'),"tc"==this.settings.format?(b="icon_win",c='<div class="win_min pae"></div><div class="win_max pae"></div><div class="win_close pae"></div>'):"sz"==this.settings.format?(b="setup_win",c='<div class="win_close pae">×</div>'):"dh"==this.settings.format&&(b="duihua_win",c='<div class="win_close pae">×</div>',d='<div class="win_confirm pae">确定</div><div class="win_cancel pae">取消</div>'),this.win=$('<div id="'+this.settings.id+'" class="'+b+' pae" kai="zhe"><div class="win_top pae"><div class="win_title pae">'+this.settings.title+"</div>"+c+'</div><div class="win_con pae"><div class="win_html pae">'+this.settings.html+"</div></div>"+d+a+"</div>"),this.initWin(),$("body").append(this.win)},initWin:function(){switch(this.win.css({width:this.settings.width,height:this.settings.height,zIndex:this.jsonOnly.zIndex++}),this.settings.wz){case"ct":this.win.css({left:(a.width()-this.settings.width)/2,top:(a.height()-this.settings.height)/2});break;case"rb":this.win.css({left:a.width()-this.settings.width,top:a.height()-this.settings.height});break;default:this.win.css({left:this.settings.wz[0],top:this.settings.wz[1]})}this.private.left=parseInt(this.win.css("left")),this.private.top=parseInt(this.win.css("top")),this.title=this.win.find(".win_title"),this.minBtn=this.win.find(".win_min"),this.maxBtn=this.win.find(".win_max"),this.closeBtn=this.win.find(".win_close"),this.finish=this.win.find(".win_confirm"),this.cancel=this.win.find(".win_cancel"),this.win.on("contextmenu",function(a){a.stopPropagation()})},xiaoWin:function(){var b=this,c=0,d=0,e=0,f=0;this.minBtn.on("click",function(){b.settings.fnXiaoWin&&(e=b.settings.fnXiaoWin(b.win)),b.win.stop().animate({width:0,height:0,left:e,top:a.height(),opacity:0},300,function(){b.private.bBtn?(c=b.settings.width,d=b.settings.height,e=b.private.left,f=b.private.top):(c=a.width(),d=a.height(),e=0,f=0),b.win.css({visibility:"hidden",opacity:1,width:c,height:d,left:e,top:f})})}).on("mousedown",function(){return!1})},daWin:function(){var a=this;this.maxBtn.on("click",function(){a.toggleWin()}).on("mousedown",function(){return!1})},dblDaWin:function(){var a=this;this.title.on("dblclick",function(){a.toggleWin()})},toggleWin:function(){var c,d;this.private.bBtn?(this.maxBtn.addClass("win_big"),this.win.stop().animate({left:b.scrollLeft(),top:b.scrollTop(),width:a.width(),height:a.height()},300)):(this.maxBtn.removeClass("win_big"),c=a.width()-this.settings.width,d=a.height()-this.settings.height,this.private.left>c&&(this.private.left=c),this.private.top>d&&(this.private.top=d),this.win.stop().animate({left:this.private.left,top:this.private.top,width:this.settings.width,height:this.settings.height},260)),this.private.bBtn=!this.private.bBtn},shutWin:function(){var a=this;this.closeBtn.on("click",function(){a.closeWin(),a.settings.fnClose&&a.settings.fnClose(a.win)}).on("mousedown",function(){return!1})},closeWin:function(){var b=this;b.win.animate({height:0,opacity:0},260,function(){b.settings.removeDisplay?(b.win.remove(),b.settings.mark&&b.mark.remove(),b.jsonOnly[b.settings.id]=void 0):(b.win.css({height:b.private.bBtn?b.settings.height:a.height(),opacity:1,visibility:"hidden"}),b.settings.mark&&b.mark.css("display","none"))})},confirm:function(a,b){this.finish.on("click",a),this.cancel.on("click",b)},dragWin:function(){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k="",l=this;this.win.on("mousedown",function(m){m.preventDefault(),m.stopPropagation(),l.private.bBtn&&(c=m.pageX,d=m.pageY,e=l.settings.width,f=l.settings.height,g=l.private.left,h=l.private.top,i=g+e,j=h+f,k=l.settings.titleDrag&&d-h<=l.title.innerHeight()?"t":l.settings.changeWin&&8>=i-c&&8>=j-d?"rb":l.settings.changeWin&&8>=i-c?"r":l.settings.changeWin&&8>=j-d?"b":l.settings.wholeDrag?"whole":"",k&&(l.settings.div=$('<div class="win_con_mark pae"></div>'),l.win.append(l.settings.div)),l.win.css("z-index",l.jsonOnly.zIndex++),l.win[0].setCapture&&l.win[0].setCapture(),b.on("mousemove",function(b){var i,j,m,n,o,p;switch(k){case"t":case"whole":i=b.pageX-c+g,j=b.pageY-d+h,l.settings.dragLimit&&(m=a.width()-e,n=a.height()-f,0>i?i=0:i>m&&(i=m),0>j?j=0:j>n&&(j=n)),l.win.css({left:i,top:j});break;case"rb":o=e+b.pageX-c,p=f+b.pageY-d,180>=o&&(o=180),120>=p&&(p=120),l.win.css({width:o,height:p});break;case"r":o=e+b.pageX-c,180>=o&&(o=180),l.win.css("width",o);break;case"b":p=f+b.pageY-d,120>=p&&(p=120),l.win.css("height",p)}}).on("mouseup",function(){$(this).off("mousemove mouseup"),l.win[0].releaseCapture&&l.win[0].releaseCapture(),l.settings.width=l.win.width(),l.settings.height=l.win.height(),l.private.left=l.win.offset().left,l.private.top=l.win.offset().top,l.settings.div&&l.settings.div.remove()}))})},createMark:function(){this.mark=$('<div id="mark'+this.settings.id+'" class="mark_elem"></div>'),this.mark.on("contextmenu",function(){return!1}).css({zIndex:this.jsonOnly.zIndex-2,height:b.height()}),$("body").append(this.mark)},onresize:function(){var b=this;a.on("resize",function(){return b.private.bBtn?(b.private.left>a.width()-b.settings.width?b.private.left=a.width()-b.settings.width:b.private.left<0&&(b.private.left=0),b.private.top>a.height()-b.settings.height?b.private.top=a.height()-b.settings.height:b.private.top<0&&(b.private.top=0),b.win.css({left:b.private.left,top:b.private.top}),void 0):(b.win.css({width:a.width(),height:a.height()}),void 0)})}},c.prototype.init.prototype=c.prototype,"object"==typeof window&&"object"==typeof window.document&&(window.cWin=c)}();